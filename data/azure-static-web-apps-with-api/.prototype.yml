title: |
  Azure Static Web Apps でウェブアプリをホストする
description: ''
published: '2026-01-31'

units:
  - title: 構成
    description: |
      Static Web Apps でフロントエンドアプリをホストして、
      Azure Functions を呼び出してみます。
    image: size=(min) architecture.png

  - cap: 構築手順

  - title: symbol=(1.) 作成
    description: |
      はじめに Static Web Apps を作成します。
      Azure コンソールにて「静的 Wweb アプリ」を開き、作成ボタンを押しましょう。
    image: size=(min) staticapp-create-init.png

  - description: |
      プランは Free を選びます。
      デプロイ方法は「その他」にします。トークンを使用してデプロイする方式です。
    image: size=(min) staticapp-create.png
  - description: |
      作成ボタンを押し、しばらく待ちます。
      構築できたら「リソースに移動」というボタンを押して、リソースの詳細を確認しましょう。
    image: size=(min) staticapp-created.png

  - title: symbol=(2.) デプロイトークンを取得
    description: |
      デプロイに必要なトークンを取得します。
      「デプロイトークンを管理」というボタンを押すと、パネルが開きトークンを確認できます。
  - image: size=(min) staticapp-deploytoken.png

  - cap: アプリを作成
    description: |
      コードを書きましょう。
      ここでは下記のような構成にしました。

      ・フロントエンド: Vite, React Router v7 (SPA)
      ・バックエンド: Python
      
  - title: コード
    code:
      open: package.json
      include:
        - api
        - api/function_app.py
        - api/host.json
        - api/pyproject.toml
        - api/uv.lock
        - app
        - app/routes
        - app/routes/home.tsx
        - app/root.tsx
        - app/routes.ts
        - app/style.css
        - .gitignore
        - pnpm-lock.yaml
        - package.json
        - react-router.config.ts
        - staticwebapp.config.json
        - swa-cli.config.json
        - tsconfig.json
        - vite.config.ts
      units:
        - description: |
            Static Web Apps の設定ファイルです。
            ここでリダイレクト等を制御できます。
          links:
            - title: https://learn.microsoft.com/ja-jp/azure/static-web-apps/configuration
              url: https://learn.microsoft.com/ja-jp/azure/static-web-apps/configuration#example-configuration-file
          mark: staticwebapp.config.json:1
        - description: |
            Static Web Apps CLI の設定ファイルです。
            ビルドコマンドを記述します。
          links:
            - title: https://learn.microsoft.com/ja-jp/azure/static-web-apps/static-web-apps-cli-configuration
              url: https://learn.microsoft.com/ja-jp/azure/static-web-apps/static-web-apps-cli-configuration
          mark: swa-cli.config.json:1
        - description: |
            ここでは Python の依存パッケージをダウンロードしてます。

            AWS Lambda にて、デプロイ時にコードを zip ファイルへ固める作業がありますが、それとだいたい一緒です。
          links:
            - title: https://docs.astral.sh/uv/guides/integration/aws-lambda/#deploying-a-zip-archive
              url: https://docs.astral.sh/uv/guides/integration/aws-lambda/#deploying-a-zip-archive
          mark: swa-cli.config.json:11
        - description: ここでバックエンドを呼び出します。
          mark: app/routes/home.tsx:9
        
        - description: |
            バックエンドのコードです。
            GET /api/info を実装します。
          mark: api/function_app.py:8
  
  - description: |
      ビルドしましょう。
    terminal: |
      $ pnpm i
      $ pnpm build

  - cap: デプロイ
    description: |
      デプロイしましょう。
      手順2で取得したトークンをセットしてください。
    terminal: |
      $ pnpm swa deploy --env production --deployment-token <DEPLOYMENT_TOKEN>
  - image: size=(min) deploy.png
  - description: |
      なお Static Web Apps には production 環境と preview 環境の2つがあります。
      デフォルトでは preview 環境へデプロイされます。production 環境へデプロイするには --env production を渡す必要があります。

  - title: 動作確認
    description: |
      ブラウザで確認しましょう。
      Azure Functions で返している文字列が表示されているので、うまくデプロイできてそうです。
    image: size=(min) staticapp-check-ui.png

  - description: |
      Azure コンソールも確認しましょう。
      Azure Functions のデプロイに成功すると、コンソールに関数名が表記されます。
    image: size=(min) staticapp-api-created.png

  - title: Links
    links:
      - title: 'https://learn.microsoft.com/ja-jp/azure/static-web-apps/overview'
        url: https://learn.microsoft.com/ja-jp/azure/static-web-apps/overview
